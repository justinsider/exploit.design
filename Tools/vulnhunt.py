#!/usr/bin/python

import os

naughty_commands = ["eval", "system", "blah"]
webserver_dir = "/var/www/html/*"
fo = open("log.txt", "wb")
banner = '''
                     _                     
   ___ _ __ ___   __| |___  ___ __ _ _ __  
  / __| '_ ` _ \ / _` / __|/ __/ _` | '_ \ 
 | (__| | | | | | (_| \__ \ (_| (_| | | | |
  \___|_| |_| |_|\__,_|___/\___\__,_|_| |_|

Name:   cmdscan.py
Desc:   Scan all php files for dangerous commands    
Author: andmuchmore                
'''
print banner
fo.write(banner)

for commands in naughty_commands:
    grep_cmd =  "grep -nHr --include *.php " + commands + " " + webserver_dir
    tmp = os.popen(grep_cmd).read()
    fo.write(tmp)
    print tmp